#!/bin/bash

# ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜YOLOè®­ç»ƒä½¿ç”¨ç¤ºä¾‹
# å±•ç¤ºå¦‚ä½•ä½¿ç”¨ --project å’Œ --name å‚æ•°

echo "ğŸš€ ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜YOLOè®­ç»ƒç¤ºä¾‹"
echo "================================"

# ç¤ºä¾‹1: åŸºæœ¬ä½¿ç”¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆåç§°ï¼‰
echo "ğŸ“ ç¤ºä¾‹1: åŸºæœ¬ä½¿ç”¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆåç§°ï¼‰"
echo "python3 detection/train_yolo_with_hard_negative.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 100 \\"
echo "    --project runs/train \\"
echo "    --mining_strategy confidence_based \\"
echo "    --hard_negative_ratio 0.3"
echo ""

# ç¤ºä¾‹2: æŒ‡å®šå®éªŒåç§°
echo "ğŸ“ ç¤ºä¾‹2: æŒ‡å®šå®éªŒåç§°"
echo "python3 detection/train_yolo_with_hard_negative.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 100 \\"
echo "    --project runs/train \\"
echo "    --name fish_detection_hard_negative_$(date +%Y%m%d_%H%M%S) \\"
echo "    --mining_strategy confidence_based \\"
echo "    --hard_negative_ratio 0.3 \\"
echo "    --confidence_threshold 0.6 \\"
echo "    --save_hard_negatives"
echo ""

# ç¤ºä¾‹3: ä½¿ç”¨ä¸åŒçš„æŒ–æ˜ç­–ç•¥
echo "ğŸ“ ç¤ºä¾‹3: ä½¿ç”¨ä¸åŒçš„æŒ–æ˜ç­–ç•¥"
echo "python3 detection/train_yolo_with_hard_negative.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 150 \\"
echo "    --project runs/train \\"
echo "    --name iou_based_mining_$(date +%Y%m%d_%H%M%S) \\"
echo "    --mining_strategy iou_based \\"
echo "    --hard_negative_ratio 0.4 \\"
echo "    --iou_threshold 0.6"
echo ""

# ç¤ºä¾‹4: å®Œæ•´å‚æ•°é…ç½®
echo "ğŸ“ ç¤ºä¾‹4: å®Œæ•´å‚æ•°é…ç½®"
echo "python3 detection/train_yolo_with_hard_negative.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 200 \\"
echo "    --batch 32 \\"
echo "    --imgsz 640 \\"
echo "    --device 0 \\"
echo "    --project runs/train \\"
echo "    --name comprehensive_hard_negative_$(date +%Y%m%d_%H%M%S) \\"
echo "    --mining_strategy confidence_based \\"
echo "    --hard_negative_ratio 0.3 \\"
echo "    --confidence_threshold 0.5 \\"
echo "    --iou_threshold 0.5 \\"
echo "    --save_hard_negatives \\"
echo "    --lr0 0.01 \\"
echo "    --patience 50 \\"
echo "    --workers 8"
echo ""

# ç¤ºä¾‹5: ä¸åŸå§‹train_yolo.pyå¯¹æ¯”
echo "ğŸ“ ç¤ºä¾‹5: ä¸åŸå§‹train_yolo.pyå¯¹æ¯”"
echo ""
echo "åŸå§‹è®­ç»ƒè„šæœ¬:"
echo "python3 detection/train_yolo.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 100 \\"
echo "    --project runs/train \\"
echo "    --name single_yolov8s_\$(date +%Y%m%d_%H%M%S)"
echo ""
echo "ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜ç‰ˆæœ¬:"
echo "python3 detection/train_yolo_with_hard_negative.py \\"
echo "    --data ./datasets/dataset.yaml \\"
echo "    --model yolov8s.pt \\"
echo "    --epochs 100 \\"
echo "    --project runs/train \\"
echo "    --name single_yolov8s_hard_negative_\$(date +%Y%m%d_%H%M%S) \\"
echo "    --mining_strategy confidence_based \\"
echo "    --hard_negative_ratio 0.3"
echo ""

echo "ğŸ¯ å‚æ•°è¯´æ˜:"
echo "  --project: è¾“å‡ºé¡¹ç›®ç›®å½•ï¼Œç”¨äºç»„ç»‡å®éªŒç»“æœ"
echo "  --name: å®éªŒåç§°ï¼Œå¦‚æœä¸æŒ‡å®šä¼šè‡ªåŠ¨ç”Ÿæˆ"
echo "  --mining_strategy: ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜ç­–ç•¥ (confidence_based, iou_based, loss_based)"
echo "  --hard_negative_ratio: ç¡¬è´Ÿæ ·æœ¬æ¯”ä¾‹ (0.0-1.0)"
echo "  --confidence_threshold: ç½®ä¿¡åº¦é˜ˆå€¼ (0.0-1.0)"
echo "  --iou_threshold: IoUé˜ˆå€¼ (0.0-1.0)"
echo "  --save_hard_negatives: ä¿å­˜ç¡¬è´Ÿæ ·æœ¬åˆ°æ–‡ä»¶"
echo ""

echo "ğŸ“ è¾“å‡ºç»“æ„:"
echo "  runs/train/"
echo "  â”œâ”€â”€ {experiment_name}/"
echo "  â”‚   â”œâ”€â”€ weights/           # è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡"
echo "  â”‚   â”œâ”€â”€ results.png        # è®­ç»ƒç»“æœå›¾è¡¨"
echo "  â”‚   â”œâ”€â”€ confusion_matrix.png"
echo "  â”‚   â”œâ”€â”€ hard_negative_report.json  # ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜æŠ¥å‘Š"
echo "  â”‚   â””â”€â”€ hard_negatives/    # ç¡¬è´Ÿæ ·æœ¬æ–‡ä»¶ï¼ˆå¦‚æœå¯ç”¨ï¼‰"
echo "  â”‚       â”œâ”€â”€ images/"
echo "  â”‚       â””â”€â”€ annotations/"
echo ""

echo "âœ… ä½¿ç”¨å»ºè®®:"
echo "1. ä½¿ç”¨æœ‰æ„ä¹‰çš„å®éªŒåç§°ï¼ŒåŒ…å«æ—¥æœŸå’Œç­–ç•¥ä¿¡æ¯"
echo "2. æ ¹æ®æ•°æ®é›†ç‰¹ç‚¹è°ƒæ•´æŒ–æ˜å‚æ•°"
echo "3. å®šæœŸæ£€æŸ¥ç¡¬è´Ÿæ ·æœ¬æŒ–æ˜æŠ¥å‘Š"
echo "4. æ¯”è¾ƒä¸åŒç­–ç•¥çš„æ•ˆæœ"
echo "5. ä½¿ç”¨ --save_hard_negatives ä¿å­˜å›°éš¾æ ·æœ¬ç”¨äºåˆ†æ"

